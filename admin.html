<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ê´€ë¦¬ì í˜ì´ì§€</title>
</head>
<body style="text-align: center; margin-top: 60px;">
  <h2>ğŸ“Š ê´€ë¦¬ì í˜ì´ì§€</h2>
  <input id="school" placeholder="í•™êµëª…">
  <input id="grade" placeholder="í•™ë…„ (ì„ íƒ)">
  <input id="class" placeholder="ë°˜ (ì„ íƒ)">
  <button onclick="loadData()">ì¡°íšŒ</button>

  <div id="results"></div>

  <script>
    function loadData() {
      const school = document.getElementById("school").value.trim();
      const grade = document.getElementById("grade").value.trim();
      const classNum = document.getElementById("class").value.trim();

      const params = new URLSearchParams({
        type: "admin",
        school,
        grade,
        class: classNum
      });

      fetch(`https://script.google.com/macros/s/AKfycbz6GfUoD2miNXN1MjnqB8vjuBv-IVDJmpGr3hYYJXF5AbQeVbiP0-ulBL0ZjGSDR7qdNg/exec?${params.toString()}`)
        .then(res => res.json())
        .then(data => {
          const results = document.getElementById("results");
          results.innerHTML = "";

          if (data.length === 0) {
            results.innerHTML = "<p>í•´ë‹¹ ì¡°ê±´ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
            return;
          }

          const grouped = {};
          data.forEach(d => {
            const key = `${d.grade}í•™ë…„ ${d.class}ë°˜`;
            if (!grouped[key]) grouped[key] = [];
            grouped[key].push(d);
          });

          for (let group in grouped) {
            const section = document.createElement("div");
            section.innerHTML = `<h3>ğŸ“˜ ${group}</h3>`;
            grouped[group].forEach(d => {
              section.innerHTML += `
                <div style="border:1px solid #ccc; margin:10px auto; padding:10px; width:300px;">
                  <p><strong>${d.number}ë²ˆ ${d.name}</strong></p>
                  <p><strong>ë‹¨ê³„:</strong> ${d.stage}</p>
                  <p><strong>ì œëª©:</strong> ${d.title}</p>
                  <p>${d.content}</p>
                  <p style="font-size: 0.8em; color: gray;">ğŸ•’ ${d.time}</p>
                </div>
              `;
            });
            results.appendChild(section);
          }
        });
    }
  </script>
</body>
</html>
